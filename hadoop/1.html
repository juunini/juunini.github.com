<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Hadoop Part.1</title>

    <link rel="stylesheet" href="/css/normalize.css">
    <link rel="stylesheet" href="./css/common.css">
    <link rel="stylesheet" href="./css/style.css">
</head>

<body>
    <div class="side">
        <p>Part. 1</p>
        <a href="javascript:void(0)">· Step. 1</a>
        <br>
        <a href="1_2.html">· Step. 2</a>
    </div>
    <div class="tab">
        <a href="javascript:void(0)">Part. 1</a>
        <a href="2.html">Part. 2</a>
        <a href="3.html">Part. 3</a>
        <a href="4.html">Part. 4</a>
        <a href="5.html">Part. 5</a>
        <a href="6.html">Part. 6</a>
    </div>
    <main>
        본 프로젝트는 [시작하세요! 하둡 프로그래밍 빅데이터 분석을 위한 하둡 기초부터 YARN까지 (정재화 지음)] 책을 보고 진행합니다.
        <br>
        <br> 위 책에서는 하둡을 이용하기 위해 4개의 CentOs 설치가 요구됩니다.
        <br> 각각의 OS는 네임노드, 세컨더리네임노드, 데이터노드 1,2 의 역할을 하게 됩니다.
        <br> 네임노드와 세컨더리의 경우에는 GUI가 필요하겠지만 책의 실습 요구 상 세컨더리네임노드도 데이터노드로 사용하기 때문에
        <br> 네임노드만 GUI 환경으로 사용하겠습니다.
        <br>
        <br> 설치 시 GUI설치를 하게되면
        <span class="colon">GNOME</span>을 설치하게 되는데 상당히 무겁고 버벅거리고 부팅, 종료 속도가 느립니다.
        <br> 그래서 저는 최소설치를 하여 필요한 요소들을 설치 후 GUI 설치를 따로 하겠습니다.
        <br>
        <br>
        <img src="./img/1_1.jpg" alt="">
        <br> 위 그림에 보이듯 설치시 네트워크 설정 부분에서 호스트 네임을 변경 가능합니다. 여기서 각각의 호스트 네임을 설정하고 설치합니다.
        <br> 그리고 덤으로 할당된 IP주소도 할당이 가능합니다.
        <br> configure 버튼을 눌러서
        <br>
        <br>
        <img src="./img/1_2.jpg" alt="">
        <br> IPv4 Settings 탭에 가서 Add 버튼을 누르고 원하는 IP를 입력한 뒤 Save를 하면 고정된 아이피가 할당된 것을 확인할 수 있습니다.
        <br> (설정부분의 이름이 Additional static address라서 고정 IP 부여입니다.)
        <br>
        <br>
        <img src="./img/1_3.jpg" alt="">
        <br> 보시듯이 IP가 변경되었습니다.
        <br> 저는 그래서, 각각 OS에 IP 할당을
        <br>
        <br>
        <span class="s6">NameNode</span>&#09;&nbsp;&nbsp;&nbsp;&nbsp;
        <span class="s2">192.168.10.100</span>
        <br>
        <span class="s6">SNameNode</span>&#09;&nbsp;&nbsp;
        <span class="s2">192.168.10.100</span>
        <br>
        <span class="s6">DataNode1</span>&#09;&nbsp;&nbsp;&nbsp;&nbsp;
        <span class="s2">192.168.10.100</span>
        <br>
        <span class="s6">DataNode2</span>&#09;&nbsp;&nbsp;&nbsp;&nbsp;
        <span class="s2">192.168.10.100</span>
        <br>
        <br> 이렇게 하였습니다.
        <br>
        <br> 각각 설치를 완료하고 나면 기본적인 툴과 필요한 것들을 설치할 차례입니다.
        <br> 먼저, 루트계정으로 로그인을 한 뒤, 터미널에 입력합니다.
        <br>
        <p class="terminal">
            <strong>[
                <span class="s4">root</span>@
                <span class="s2">NameNode</span> ~]#</strong> yum -y update
            <br>
            <strong>[
                <span class="s4">root</span>@
                <span class="s2">NameNode</span> ~]#</strong> yum install -y net-tools
            <br>
            <span class="blur">(net-tools를 설치하지 않으면 ifconfig등의 기능을 사용할 수 없습니다.)</span>
            <br>
            <strong>[
                <span class="s4">root</span>@
                <span class="s2">NameNode</span> ~]#</strong> ifconfig
        </p>
        처음에 고정IP를 할당했음에도 IP가 제멋대로 할당된 것을 확인할 수 있습니다.
        <br> 여러번 시도 해 보았으나 바꾸고 나면 문제가 생겨서 그대로 쓰기로 하였습니다.
        <br> 그래서 확인된 IP는
        <br>
        <br>
        <span class="s6">NameNode</span>&#09;&nbsp;&nbsp;&nbsp;&nbsp;
        <span class="s2">192.168.10.133</span>
        <br>
        <span class="s6">SNameNode</span>&#09;&nbsp;&nbsp;
        <span class="s2">192.168.10.135</span>
        <br>
        <span class="s6">DataNode1</span>&#09;&nbsp;&nbsp;&nbsp;&nbsp;
        <span class="s2">192.168.10.136</span>
        <br>
        <span class="s6">DataNode2</span>&#09;&nbsp;&nbsp;&nbsp;&nbsp;
        <span class="s2">192.168.10.137</span>
        <br> 입니다.
        <br>
        <br>
        <p class="terminal">
            <strong>[
                <span class="s4">root</span>@
                <span class="s2">NameNode</span> ~]#
            </strong> echo $LANG
            <br> en_US.UTF-8
        </p>
        을 입력하여 현재 CharSet을 확인합니다. UTF-8로 설정되어 있어야 합니다.
        <br> 기본 설정이 UTF-8로 되어있으므로 넘어가겠습니다.
        <br>
        <br> 다음은
        <span class="colon">JAVA</span>를 설치할 차례입니다.
        <br>
        <span class="colon">Oracle</span> 사이트에 들어가서
        <span class="colon">JAVA SE</span>의 최신버전을 다운받아야 하는게 정석이지만,
        <br> CLI 모드이기도 하고 약간 귀찮기도 하니
        <span class="colon">yum</span>으로 설치하겠습니다.
        <br>
        <p class="terminal">
            <strong>[
                <span class="s4">root</span>@
                <span class="s2">NameNode</span> ~]#
            </strong> yum list java*jdk-devel
            <br> Loaded plugins: fastestmirror
            <br> Loading mirror speeds from cached hostfile
            <br> * base: data.nicehosting.co.kr
            <br> * extras: data.nicehosting.co.kr
            <br> * updates: data.nicehosting.co.kr
            <br> Avilable Packages
            <br> java-1.6.0-openjdk-devel.x86_64
            <br> java-1.7.0-openjdk-devel.x86_64
            <br> java-1.8.0-openjdk-devel.i686
            <br> java-1.8.0-openjdk-devel.x86_64
            <br>
        </p>
        <span class="colon">yum list [package name]</span> 명령어는 연관 패키지를 찾아주는 명령어입니다.
        <br> 여기서 나온 것들 중, i686은 32비트 운영체제를 위한 것이므로 무시하고, 맨 밑에 있는 openjdk의 최신버전을 설치하겠습니다.
        <br>
        <br>
        <p class="terminal">
            <strong>[
                <span class="s4">root</span>@
                <span class="s2">NameNode</span> ~]#
            </strong> yum install -y java-1.8.0-openjdk-devel.x86_64
            <br>
        </p>
        패키지가 전부 설치되고 나면 설치가 잘 되었는지 확인해야하고 설치경로도 확인하여 환경변수에 추가하여야 합니다.
        <br>
        <br>
        <p class="terminal">
            <strong>[
                <span class="s4">root</span>@
                <span class="s2">NameNode</span> ~]#
            </strong> javac -version
            <br> javac 1.8.0_151
            <br>
            <strong>[
                <span class="s4">root</span>@
                <span class="s2">NameNode</span> ~]#
            </strong> which javac
            <br> /bin/javac
            <br>
            <strong>[
                <span class="s4">root</span>@
                <span class="s2">NameNode</span> ~]#
            </strong> readlink -f /bin/javac
            <br> /usr/lib/jvm/java-1.8.0-openjdk-1.8.0.151-5.b12.el7_4.x86_64/bin/javac
            <br>
        </p>
        이렇게 하여 설치경로를 파악할 수 있습니다.
        <br> 설치경로는
        <br>
        <span class="s2">/usr/lib/jvm/java-1.8.0-openjdk-1.8.0.151-5.b12.el7_4.x86_64</span>
        <br> 입니다.
        <br> 환경변수에 추가하도록 하겠습니다.
        <br>
        <br>
        <p class="terminal">
            <strong>[
                <span class="s4">root</span>@
                <span class="s2">NameNode</span> ~]#
            </strong> vi /etc/profile
            <br>
            <br>
            <span class="blur">맨 하단으로 가서 추가합니다.</span>
            <br>
            <br>
            <i class="s4">export</i>
            <span class="colon">JAVA_HOME</span>=
            <span class="s2">/usr/lib/jvm/java-1.8.0-openjdk-1.8.0.151-5.b12.el7_4.x86_64</span>
            <br>
            <i class="s4">export</i>
            <span class="colon">PATH</span>=
            <span class="s2">$PATH:$JAVA_HOME/bin</span>
            <br>
            <i class="s4">export</i>
            <span class="colon">CLASS_PATH</span>=
            <span class="s2">"."</span>
            <br>
            <br>
            <br>
            <strong>[
                <span class="s4">root</span>@
                <span class="s2">NameNode</span> ~]#
            </strong> source /etc/profile
            <br>
            <strong>[
                <span class="s4">root</span>@
                <span class="s2">NameNode</span> ~]#
            </strong> $JAVA_HOME/bin/javac -version
            <br> javac 1.8.0_151
            <br>
        </p>
        이렇게 하면
        <span class="colon">JAVA</span>의 환경변수 설정이 완료됩니다.
        <br>
        <br> 다음 단계는 SSH설정 단계입니다.
        <br> 설정에 앞서 호스트 설정을 먼저 하겠습니다.
        <br>
        <br>
        <p class="terminal">
            <strong>[
                <span class="s4">root</span>@
                <span class="s2">NameNode</span> ~]#
            </strong> vi /etc/hosts
            <br>
            <br>
            <span class="blur">(맨 아랫줄에 추가합니다.)</span>
            <br> 192.168.10.133 NameNode
            <br> 192.168.10.135 SNameNode
            <br> 192.168.10.136 DataNode1
            <br> 192.168.10.137 DataNode2
            <br>
        </p>
        설정을 마치고나면
        <span class="colon">openssh</span>를 설치하여야 합니다.
        <br>
        <br>
        <p class="terminal">
            <strong>[
                <span class="s4">root</span>@
                <span class="s2">NameNode</span> ~]#
            </strong> yum install -y openssh*
            <br>
            <strong>[
                <span class="s4">root</span>@
                <span class="s2">NameNode</span> ~]#
            </strong> systemctl restart network
            <br>
            <strong>[
                <span class="s4">root</span>@
                <span class="s2">NameNode</span> ~]#
            </strong> vi /etc/ssh/sshd_config
            <br>
            <span class="blur">(
                <span class="s2">#Port 22</span> 부분의 #을 지운다.)</span>
            <br>
            <strong>[
                <span class="s4">root</span>@
                <span class="s2">NameNode</span> ~]#
            </strong> systemctl start sshd.service
            <br>
            <strong>[
                <span class="s4">root</span>@
                <span class="s2">NameNode</span> ~]#
            </strong> firewall-cmd --zone=public --add-port=22/tcp --permanent
            <br>
            <strong>[
                <span class="s4">root</span>@
                <span class="s2">NameNode</span> ~]#
            </strong> firewall-cmd --reload
            <br>
        </p>
        이까지 하면
        <span class="colon">SSH 포트</span>가 열리게 됩니다. 아마 계속 루트계정으로만 작업해서 모르시겠지만, 유저 계정으로 들어가서
        <span class="colon">sudo</span> 명령어를 입력하면 에러가 나는걸 확인하실 수 있습니다.
        <br> 문제를 먼저 해결하고 진행하도록 하겠습니다.
        <br>
        <br>
        <p class="terminal">
            <strong>[
                <span class="s4">root</span>@
                <span class="s2">NameNode</span> ~]#
            </strong> visudo
            <br>
            <br> root ALL=(ALL) ALL
            <br>
            <span class="blur">(이 부분을 찾아서 아래에 추가합니다.)</span>
            hadoop ALL=(ALL) ALL
            <br>
        </p>
        이렇게 하면 sudo 명령어의 에러가 나지 않게 됩니다.
        <br> 이제 네임노드로 SSH 공개키를 만들어 나머지 데이터 노드에 뿌리는 작업을 합니다.
        <br>
        <br>
        <p class="terminal">
            <strong>[
                <span class="s4">hadoop</span>@
                <span class="s2">NameNode</span> ~]$
            </strong> ssh-keygen
            <br>
        </p>
        <img src="./img/1_4.png" alt="">
        <br> 위와 같이 나오면 공개키가 만들어진 겁니다.
        <br> 이제 데이터 노드에 공개키를 나눠주겠습니다.
        <br>
        <br>
        <p class="terminal">
            <strong>[
                <span class="s4">hadoop</span>@
                <span class="s2">NameNode</span> ~]$
            </strong> ssh-copy-id -i /home/hadoop/.ssh/id_rsa.pub hadoop@SNameNode
            <br> /bin/ssh-copy-id: INFO: Source of key(s) to be installed: "/home/hadoop/.ssh/id_rsa.pub"
            <br> The authenticity of host 'snamenode (192.168.10.135)' can't bo established.
            <br> ECDSA key fingerprint is SHA256:Mg2Je/..........
            <br> ECDSA key fingerprint is MD5:39:87:.............
            <br> Are you sure you wnad to continue connecting (yes/no)? yes
            <br> /bin/ssh-copy-id: INFO: attempting to log in with the new key(s), to filter out any that are already installed
            <br> /bin/ssh-copy-id: INFO: 1 key(s) remain to be installed -- if you are prompted now it is to install the new
            keys hadoop@snamenode's passwd:
            <br>
            <br> Number of key(s) added: 1
            <br>
            <br> Now try logging into the machine, with: "ssh 'hadoop@SNameNode'"
            <br> and check to make user that only the key(s) you wanted were added.
            <br>
            <strong>[
                <span class="s4">hadoop</span>@
                <span class="s2">NameNode</span> ~]$
            </strong> ssh SnameNode
            <br>
            <strong>[
                <span class="s4">hadoop</span>@
                <span class="s2">SNameNode</span> ~]$
            </strong>
        </p>
        이렇게 나오면 SSH 공개키 배포에 성공한 것입니다. 나머지 데이터노드에도 실행합니다.
        <br>
        <br>
        <p class="terminal">
            <strong>[
                <span class="s4">hadoop</span>@
                <span class="s2">SNameNode</span> ~]$
            </strong> exit
            <br> logout
            <br> Connection to snamenode closed.
            <br>
            <strong>[
                <span class="s4">hadoop</span>@
                <span class="s2">NameNode</span> ~]$
            </strong> ssh-copy-id -i /home/hadoop/.ssh/id_rsa.pub hadoop@DataNode1
            <br> /bin/ssh-copy-id: INFO: Source of key(s) to be installed: "/home/hadoop/.ssh/id_rsa.pub"
            <br> The authenticity of host 'datanode1 (192.168.10.136)' can't bo established.
            <br> ECDSA key fingerprint is SHA256:Mg2Je/..........
            <br> ECDSA key fingerprint is MD5:39:87:.............
            <br> Are you sure you wnad to continue connecting (yes/no)? yes
            <br> /bin/ssh-copy-id: INFO: attempting to log in with the new key(s), to filter out any that are already installed
            <br> /bin/ssh-copy-id: INFO: 1 key(s) remain to be installed -- if you are prompted now it is to install the new
            keys hadoop@datanode1's passwd:
            <br>
            <br> Number of key(s) added: 1
            <br>
            <br> Now try logging into the machine, with: "ssh 'hadoop@DataNode1'"
            <br> and check to make user that only the key(s) you wanted were added.
            <br>
            <strong>[
                <span class="s4">hadoop</span>@
                <span class="s2">NameNode</span> ~]$
            </strong> ssh-copy-id -i /home/hadoop/.ssh/id_rsa.pub hadoop@DataNode2
            <br> /bin/ssh-copy-id: INFO: Source of key(s) to be installed: "/home/hadoop/.ssh/id_rsa.pub"
            <br> The authenticity of host 'datanode2 (192.168.10.137)' can't bo established.
            <br> ECDSA key fingerprint is SHA256:Mg2Je/..........
            <br> ECDSA key fingerprint is MD5:39:87:.............
            <br> Are you sure you wnad to continue connecting (yes/no)? yes
            <br> /bin/ssh-copy-id: INFO: attempting to log in with the new key(s), to filter out any that are already installed
            <br> /bin/ssh-copy-id: INFO: 1 key(s) remain to be installed -- if you are prompted now it is to install the new
            keys hadoop@datanode2's passwd:
            <br>
            <br> Number of key(s) added: 1
            <br>
            <br> Now try logging into the machine, with: "ssh 'hadoop@DataNode2'"
            <br> and check to make user that only the key(s) you wanted were added.
            <br>
        </p>
        이렇게 해서 각각의 노드에 SSH 공개키 배포가 끝났습니다.
        <br> 이제 하둡을 설치할 차례입니다.
        <br>
        <span class="colon">wget</span>을 통해 하둡을 다운받을건데 최소설치를 했기 때문에 wget도 설치해야 합니다.
        <br>
        <br>
        <p class="terminal">
            <strong>[
                <span class="s4">hadoop</span>@
                <span class="s2">NameNode</span> ~]$
            </strong> sudo yum install -y wget
            <br>
            <strong>[
                <span class="s4">hadoop</span>@
                <span class="s2">NameNode</span> ~]$
            </strong> wget "http://www.eu.apache.org/dist/hadoop/common/hadoop-1.2.1/hadoop-1.2.1.tar.gz"
            <br>
            <strong>[
                <span class="s4">hadoop</span>@
                <span class="s2">NameNode</span> ~]$
            </strong> tar xvfz hadoop-1.2.1.tar.gz
            <br>
            <strong>[
                <span class="s4">hadoop</span>@
                <span class="s2">NameNode</span> ~]$
            </strong> rm hadoop-1.2.1.tar.gz
            <br>
            <strong>[
                <span class="s4">hadoop</span>@
                <span class="s2">NameNode</span> ~]$
            </strong> ls
            <br>
            <strong class="s3">hadoop-1.2.1</strong>
        </p>
        이렇게 나오면 하둡 설치가 성공적으로 완료된 것입니다.
        <br> 나머지는 다음 페이지에서 진행하도록 하겠습니다.
        <br>

        <a href="./1_2.html" class="colon">다음 페이지로</a>
    </main>

</body>

</html>