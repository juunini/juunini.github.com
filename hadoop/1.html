<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Hadoop Part. 1</title>

    <link rel="stylesheet" href="/css/normalize.css">
    <link rel="stylesheet" href="./css/common.css">
    <link rel="stylesheet" href="./css/style.css">
</head>

<body>
    <div class="side">
        <p>Part. 1</p>
        <a href="javascript:void(0)">· Step. 1</a>
        <br>
        <a href="1_2.html">· Step. 2</a>
        <br>
        <a href="1_3.html">· Step. 3</a>
    </div>
    <div class="tab">
        <a href="javascript:void(0)">Part. 1</a>
        <a href="2.html">Part. 2</a>
        <a href="3.html">Part. 3</a>
        <a href="4.html">Part. 4</a>
        <a href="5.html">Part. 5</a>
        <a href="6.html">Part. 6</a>
    </div>
    <main>
        본 프로젝트는 [시작하세요! 하둡 프로그래밍 빅데이터 분석을 위한 하둡 기초부터 YARN까지 (정재화 지음)] 책을 보고 진행합니다.
        <br>
        <br> 위 책에서는 하둡을 이용하기 위해 4개의 CentOs 설치가 요구됩니다.
        <br> 각각의 OS는 네임노드, 세컨더리네임노드, 데이터노드 1,2 의 역할을 하게 됩니다.
        <br> 네임노드와 세컨더리의 경우에는 GUI가 필요하겠지만 책의 실습 요구 상 세컨더리네임노드도 데이터노드로 사용하기 때문에
        <br> 네임노드만 GUI 환경으로 사용하겠습니다.
        <br>
        <br> 설치 시 GUI설치를 하게되면
        <span class="colon">GNOME</span>을 설치하게 되는데 상당히 무겁고 버벅거리고 부팅, 종료 속도가 느립니다.
        <br> 그래서 저는 최소설치를 하여 필요한 요소들을 설치 후 GUI 설치를 따로 하겠습니다.<br>
        <br>
        <span class="s2">덤으로, 일단 네임노드 하나만 설치한 뒤에 필요한 요소를 설치하고나서, 가상파일을 복사해서<br>
        보조네임노드와 데이터노드들을 만들도록 하겠습니다. 똑같은 설치과정을 4번이나 거칠 필요는 없으니까요.<br></span>
        <br>
        <img src="./img/1_1.jpg" alt="">
        <br> 위 그림에 보이듯 설치시 네트워크 설정 부분에서 호스트 네임을 변경 가능합니다. 여기서 호스트 네임을 설정하고 설치합니다.<br>
        <span class="blur">(SNameNode 라고 되어있지만 NameNode로 해주세요.)</span>
        <br> 그리고 덤으로 할당된 IP주소도 할당이 가능합니다.
        <br> configure 버튼을 눌러서
        <br>
        <br>
        <img src="./img/1_2.jpg" alt="">
        <br> IPv4 Settings 탭에 가서 Add 버튼을 누르고 원하는 IP를 입력한 뒤 Save를 하면 고정된 아이피가 할당된 것을 확인할 수 있습니다.
        <br> (설정부분의 이름이 Additional static address라서 고정 IP 부여입니다.)
        <br>
        <br>
        <img src="./img/1_3.jpg" alt="">
        <br> 보시듯이 IP가 변경되었습니다.<br>
        근데 <span class="s6">아무 소용 없습니다.</span> 여러번 시도 해봤지만 VMware Pro 버전이 아니면 고정IP로 할당이 힘듭니다.<br>
        어차피 부팅해서 ifconfig 쳐보면 저 IP 안나와요.<br>
        그냥 할게요. 그냥 주어지는 IP로 진행하겠습니다.<br>
        <br>
        먼저, 루트계정으로 로그인을 한 뒤, 터미널에 입력합니다.<br>
        필요한 것들을 먼저 수행한 뒤 하둡을 설치하겠습니다.<br>
        <br>
        <p class="terminal">
            <strong>[
                <span class="s4">root</span>@
                <span class="s2">NameNode</span> ~]#</strong> yum -y update
            <br>
            <strong>[
                <span class="s4">root</span>@
                <span class="s2">NameNode</span> ~]#</strong> yum install -y net-tools
            <br>
            <span class="blur">(net-tools를 설치하지 않으면 ifconfig등의 기능을 사용할 수 없습니다.)</span><br>
            <br>
            <strong>[
                <span class="s4">root</span>@
                <span class="s2">NameNode</span> ~]#</strong> yum install -y openssh*<br>
            <strong>[
                <span class="s4">root</span>@
                <span class="s2">NameNode</span> ~]#
            </strong> systemctl restart network<br>
            <strong>[
                <span class="s4">root</span>@
                <span class="s2">NameNode</span> ~]#
            </strong> vi /etc/ssh/sshd_config<br>
            <span class="blur">(<span class="s2">#Port 22</span> 부분의 주석인 #을 지웁니다.)</span><br>
            <br>
            <strong>[
                <span class="s4">root</span>@
                <span class="s2">NameNode</span> ~]#
            </strong> systemctl start sshd.service<br>
            <span class="blur">(SSH 포트가 열렸습니다.)</span><br>
            <br>
            <strong>[
                <span class="s4">root</span>@
                <span class="s2">NameNode</span> ~]#
            </strong> systemctl disable firewalld<br>
            <strong>[
                <span class="s4">root</span>@
                <span class="s2">NameNode</span> ~]#
            </strong> systemctl stop firewalld<br>
            <strong>[
                <span class="s4">root</span>@
                <span class="s2">NameNode</span> ~]#
            </strong> systemctl mask firewalld<br>
            <span class="blur">(방화벽을 끄고 재부팅해도 방화벽이 켜지지 않게 합니다.)</span><br>
            <span class="blur">(방화벽을 꺼야 데이터노드와 연동이 됩니다. 아직 방화벽을 켜고 하는 방법은 모르겠습니다.)</span><br>
            <br>
            <strong>[
                <span class="s4">root</span>@
                <span class="s2">NameNode</span> ~]#
            </strong> yum list java*jdk-devel
            <br> Loaded plugins: fastestmirror
            <br> Loading mirror speeds from cached hostfile
            <br> * base: data.nicehosting.co.kr
            <br> * extras: data.nicehosting.co.kr
            <br> * updates: data.nicehosting.co.kr
            <br> Avilable Packages
            <br> java-1.6.0-openjdk-devel.x86_64
            <br> java-1.7.0-openjdk-devel.x86_64
            <br> java-1.8.0-openjdk-devel.i686
            <br> java-1.8.0-openjdk-devel.x86_64
            <br>
            <span class="blur">(자바 jdk의 리스트를 조회한 결과입니다.)</span><br>
            <br>
            <strong>[
                <span class="s4">root</span>@
                <span class="s2">NameNode</span> ~]#
            </strong> yum install -y java-1.8.0-openjdk-devel.x86_64
            <br>
            <strong>[
                <span class="s4">root</span>@
                <span class="s2">NameNode</span> ~]#
            </strong> javac -version<br>
             javac 1.8.0_151<br>
            <strong>[
                <span class="s4">root</span>@
                <span class="s2">NameNode</span> ~]#
            </strong> which javac<br>
             /bin/javac<br>
            <strong>[
                <span class="s4">root</span>@
                <span class="s2">NameNode</span> ~]#
            </strong> readlink -f /bin/javac<br>
            /usr/lib/jvm/java-1.8.0-openjdk-1.8.0.151-5.b12.el7_4.x86_64/bin/javac<br>
            <span class="blur">(저 폴더의 이름이 너무 길어서 좀 줄이겠습니다.)</span><br>
            <br>
            <strong>[
                <span class="s4">root</span>@
                <span class="s2">NameNode</span> ~]#
            </strong> cd /usr/lib/jvm<br>
            <strong>[
                <span class="s4">root</span>@
                <span class="s2">NameNode</span> <span class="s3">jvm</span>]#
            </strong> mv java-1.8.0-openjdk-1.8.0.151-5.b12.el7_4.x86_64 jdk-1.8.0<br>
            <span class="blur">(자바폴더의 이름이 jdk-1.8.0으로 변합니다.)</span><br>
            <br>
            <br>
            <strong>[
                <span class="s4">root</span>@
                <span class="s2">NameNode</span> ~]#
            </strong> vi /etc/profile
            <br>
            <br>
            <span class="blur">맨 하단으로 가서 추가합니다.</span>
            <br>
            <br>
            <i class="s4">export</i>
            <span class="colon">JAVA_HOME</span>=
            <span class="s2">/usr/lib/jvm/jdk-1.8.0</span>
            <br>
            <i class="s4">export</i>
            <span class="colon">PATH</span>=
            <span class="s2">$PATH:$JAVA_HOME/bin</span>
            <br>
            <i class="s4">export</i>
            <span class="colon">CLASS_PATH</span>=
            <span class="s2">"."</span>
            <br>
            <br>
            <br>
            <strong>[
                <span class="s4">root</span>@
                <span class="s2">NameNode</span> ~]#
            </strong> source /etc/profile
            <br>
            <strong>[
                <span class="s4">root</span>@
                <span class="s2">NameNode</span> ~]#
            </strong> $JAVA_HOME/bin/javac -version
            <br> javac 1.8.0_151<br>
            <strong>[
                <span class="s4">root</span>@
                <span class="s2">NameNode</span> ~]#
            </strong> javac -version<br>
             javac 1.8.0_151<br>
             <span class="blur">(자바 환경변수 설정이 완료되었습니다.)</span><br>
             <br>
            <strong>[
                <span class="s4">root</span>@
                <span class="s2">NameNode</span> ~]#
            </strong> echo $LANG
            <br> en_US.UTF-8<br>
            <span class="blur">(현재 CharacterSet이 UTF-8로 설정되어 있어야 합니다.)</span><br>
            <span class="blur">(기본 설정이 UTF-8로 되어있으므로 넘어가겠습니다.)</span><br>
        </p>
        아마 계속 루트계정으로만 작업해서 모르시겠지만, 유저 계정으로 들어가서
        <span class="colon">sudo</span> 명령어를 입력하면 에러가 나는걸 확인하실 수 있습니다.
        <br> 문제를 먼저 해결하고 진행하도록 하겠습니다.
        <br>
        <br>
        <p class="terminal">
            <strong>[
                <span class="s4">root</span>@
                <span class="s2">NameNode</span> ~]#
            </strong> visudo
            <br>
            <br> root ALL=(ALL) ALL
            <br>
            <span class="blur">(이 부분을 찾아서 아래에 추가합니다.)</span><br>
            hadoop ALL=(ALL) ALL
            <br>
        </p>
        이렇게 하면 sudo 명령어의 에러가 나지 않게 됩니다.<br>
        이제, 필요한 패키지는 모두 설치가 되었습니다. 가상파일을 복제해서<br>
        보조네임노드와 데이터노드 2개를 만들도록 합니다.
        <br>
        <br>
        복사해서 만들고 나면 각각 가상머신의 호스트 네임을 변경해줘야 합니다.<br>
        <br>
        <p class="terminal">
            <strong>[
                <span class="s4">hadoop</span>@
                <span class="s2">NameNode</span> ~]$
            </strong> nmtui
            <br>
        </p>
        <br>
        <img src="./img/1_4.jpg" alt="">
        <br>
        명령어를 입력하면 위 사진같은 화면이 나옵니다.<br>
        세번째를 선택하면 호스트네임 변경이 가능합니다.<br>
        <br>
        다 끝났으면 조금은 귀찮지만 각각의 ip를 확인한 뒤에 /etc/hosts에 추가하는 작업을 해야 합니다.<br>
        <br>
        <p class="terminal">
            <strong>[
                <span class="s4">hadoop</span>@
                <span class="s2">NameNode</span> ~]$
            </strong> ifconfig
            <br>
        </p>
        <br>
        명령어를 입력하면 ip정보를 조회할 수 있습니다. 그 뒤에,<br>
        <br>
        <p class="terminal">
            <strong>[
                <span class="s4">hadoop</span>@
                <span class="s2">NameNode</span> ~]$
            </strong> vi /etc/hosts<br>
            <br>
            <span class="blur">(맨 아래에 추가합니다.)</span><br>
             192.168.10.144 NameNode
            <br>
             192.168.10.145 SNameNode
            <br>
             192.168.10.146 DataNode1
            <br>
             192.168.10.147 DataNode2
            <br>
        </p>
        <br>
        각각의 가상머신에 설정을 마치고 나면, 네임노드에서 SSH의 공개키를<br>
        가상머신들에게 나눠주어 인증을 시키는 일을 해야합니다.<br>
        <br>
        <p class="terminal">
            <strong>[
                <span class="s4">hadoop</span>@
                <span class="s2">NameNode</span> ~]$
            </strong> ssh-keygen
            <br>
        </p>
        <br>
        <img src="./img/1_5.png" alt="">
        <br> 위와 같이 나오면 공개키가 만들어진 겁니다.
        <br> 이제 데이터 노드에 공개키를 나눠주겠습니다.
        <br>
        <br>
        <p class="terminal">
            <strong>[
                <span class="s4">hadoop</span>@
                <span class="s2">NameNode</span> ~]$
            </strong> ssh-copy-id -i /home/hadoop/.ssh/id_rsa.pub hadoop@SNameNode
            <br> /bin/ssh-copy-id: INFO: Source of key(s) to be installed: "/home/hadoop/.ssh/id_rsa.pub"
            <br> The authenticity of host 'snamenode (192.168.10.135)' can't bo established.
            <br> ECDSA key fingerprint is SHA256:Mg2Je/..........
            <br> ECDSA key fingerprint is MD5:39:87:.............
            <br> Are you sure you wnad to continue connecting (yes/no)? yes
            <br> /bin/ssh-copy-id: INFO: attempting to log in with the new key(s), to filter out any that are already installed
            <br> /bin/ssh-copy-id: INFO: 1 key(s) remain to be installed -- if you are prompted now it is to install the new
            keys hadoop@snamenode's passwd:
            <br>
            <br> Number of key(s) added: 1
            <br>
            <br> Now try logging into the machine, with: "ssh 'hadoop@SNameNode'"
            <br> and check to make user that only the key(s) you wanted were added.
            <br>
            <strong>[
                <span class="s4">hadoop</span>@
                <span class="s2">NameNode</span> ~]$
            </strong> ssh SnameNode
            <br>
            <strong>[
                <span class="s4">hadoop</span>@
                <span class="s2">SNameNode</span> ~]$
            </strong>
        </p>
        이렇게 나오면 SSH 공개키 배포에 성공한 것입니다. 나머지 데이터노드에도 실행합니다.
        <br>
        <br>
        <p class="terminal">
            <strong>[
                <span class="s4">hadoop</span>@
                <span class="s2">SNameNode</span> ~]$
            </strong> exit
            <br> logout
            <br> Connection to snamenode closed.
            <br>
            <strong>[
                <span class="s4">hadoop</span>@
                <span class="s2">NameNode</span> ~]$
            </strong> ssh-copy-id -i /home/hadoop/.ssh/id_rsa.pub hadoop@DataNode1
            <br> /bin/ssh-copy-id: INFO: Source of key(s) to be installed: "/home/hadoop/.ssh/id_rsa.pub"
            <br> The authenticity of host 'datanode1 (192.168.10.136)' can't bo established.
            <br> ECDSA key fingerprint is SHA256:Mg2Je/..........
            <br> ECDSA key fingerprint is MD5:39:87:.............
            <br> Are you sure you wnad to continue connecting (yes/no)? yes
            <br> /bin/ssh-copy-id: INFO: attempting to log in with the new key(s), to filter out any that are already installed
            <br> /bin/ssh-copy-id: INFO: 1 key(s) remain to be installed -- if you are prompted now it is to install the new
            keys hadoop@datanode1's passwd:
            <br>
            <br> Number of key(s) added: 1
            <br>
            <br> Now try logging into the machine, with: "ssh 'hadoop@DataNode1'"
            <br> and check to make user that only the key(s) you wanted were added.
            <br>
            <strong>[
                <span class="s4">hadoop</span>@
                <span class="s2">NameNode</span> ~]$
            </strong> ssh-copy-id -i /home/hadoop/.ssh/id_rsa.pub hadoop@DataNode2
            <br> /bin/ssh-copy-id: INFO: Source of key(s) to be installed: "/home/hadoop/.ssh/id_rsa.pub"
            <br> The authenticity of host 'datanode2 (192.168.10.137)' can't bo established.
            <br> ECDSA key fingerprint is SHA256:Mg2Je/..........
            <br> ECDSA key fingerprint is MD5:39:87:.............
            <br> Are you sure you wnad to continue connecting (yes/no)? yes
            <br> /bin/ssh-copy-id: INFO: attempting to log in with the new key(s), to filter out any that are already installed
            <br> /bin/ssh-copy-id: INFO: 1 key(s) remain to be installed -- if you are prompted now it is to install the new
            keys hadoop@datanode2's passwd:
            <br>
            <br> Number of key(s) added: 1
            <br>
            <br> Now try logging into the machine, with: "ssh 'hadoop@DataNode2'"
            <br> and check to make user that only the key(s) you wanted were added.
            <br>
        </p>
        이렇게 해서 각각의 노드에 SSH 공개키 배포가 끝났습니다.
        <br> 이제 하둡을 설치할 차례입니다.
        <br>
        <span class="colon">wget</span>을 통해 하둡을 다운받을건데 최소설치를 했기 때문에 wget도 설치해야 합니다.
        <br>
        <br>
        <p class="terminal">
            <strong>[
                <span class="s4">hadoop</span>@
                <span class="s2">NameNode</span> ~]$
            </strong> sudo yum install -y wget
            <br>
            <strong>[
                <span class="s4">hadoop</span>@
                <span class="s2">NameNode</span> ~]$
            </strong> wget "http://www.eu.apache.org/dist/hadoop/common/hadoop-1.2.1/hadoop-1.2.1.tar.gz"
            <br>
            <strong>[
                <span class="s4">hadoop</span>@
                <span class="s2">NameNode</span> ~]$
            </strong> tar xvfz hadoop-1.2.1.tar.gz
            <br>
            <strong>[
                <span class="s4">hadoop</span>@
                <span class="s2">NameNode</span> ~]$
            </strong> rm hadoop-1.2.1.tar.gz
            <br>
            <strong>[
                <span class="s4">hadoop</span>@
                <span class="s2">NameNode</span> ~]$
            </strong> ls
            <br>
            <strong class="s3">hadoop-1.2.1</strong><br>
            <strong>[
                <span class="s4">hadoop</span>@
                <span class="s2">NameNode</span> ~]$
            </strong> mv hadoop-1.2.1 hadoop<br>
            <span class="blur">(하둡 폴더의 이름을 변경합니다.)</span>
        </p>
        이렇게 나오면 하둡 설치가 성공적으로 완료된 것입니다.
        <br> 나머지는 다음 페이지에서 진행하도록 하겠습니다.
        <br>
        <br>
        <a href="./1_2.html" class="colon" style="text-decoration: underline;">다음 페이지로</a>
    </main>

</body>

</html>